---
{"dg-publish":true,"dg-path":"文章/2022-09-29 诊断服务说明.md","permalink":"/文章/2022-09-29 诊断服务说明/","dgEnableSearch":"true"}
---

#Technomous 

**10** **服务：** 

10 服务用来切换三种或更多模式，默认模式用来支持默认状态下支持的各个服务，编程模式用来支持与编程相关的服务，扩展模式一般用来在非默认模式下支持的一些服务。 

为什么要这么做？其实就是为了管理各个服务，让各个服务在一个池子里面，只有进入这个池子，你 才有权限去访问各个服务。 

数据应答规则举例大致说明一下： 

请求:CANID 02 10 03 （02 对应数据长度，10 表示 10 服务，03 表示 10 服务的子服务，该请求的目的就是切换到扩展模式，其他模式切换类似） 

答复：CANID 06 50 03 xx xx xx xx （06 对应数据长度，50 表示 10 服务（+0x40），03 表示 10 服务的子服务，该答复的目的就是切换到扩展模式，其他模式切换类似） 

有兴趣的朋友可以深入研究一下。 

**11** **服务：** 

对应的就是复位服务，其中包括了子服务硬件复位 01 子服务 KeyOfOn 复位 02 子服务软件服务 03； 

其中三种子服务都是通过操作软件来进行对应的复位操作。 

数据应答规则 

请求：CANID 02 11 01 
答复：CANID 02 52 01 

**14** **服务：** 

对应的就是清除故障服务 

他可清除一个故障信息，也可以清除一组故障信息。 

应答规则后面不讲了，有兴趣的朋友可支持参考 14229 协议。 

**19** **服务：** 

这个服务主要用来，查询故障信息，这个服务非常复杂，需要费很大的力气才能讲清楚，下面我仅仅 对常用的几种子服务进行介绍，其实所有定义的服务，无非就是为了快速查找到需要的故障信息。 

**01** **子服务**：通过状态掩码的形式去，查找该状态掩码匹配的故障个数，其实意思就是查找故障个数， 这里稍微解释一下状态掩码，在 UDS 规定里面，每个故障都对应 8 个状态，每个状态对应一个 bit， 

比如状态 0 对应 bit0，表示当前发生的故障，状态 3 对应 bit3，表示已经确认的故障等等，那么状态掩码的意思就是用一个 8bit 的数去按位与，如果与的结果与的结果非 0 表示匹配到了，然后故障数就 ++。 

**02** **子服务**：通过状态掩码的形式去，查找匹配的故障，以及故障的状态。 

**04** **子服务**：请求指定故障码（DTC）的快照信息，意思就是说为了找到故障的原因，查找故障发生时 刻的一些数据，来分析故障原因。 

**06** **子服务**：请求指定故障码（DTC）的扩展信息，就是想了解一些该故障的一些其他信息，比如发生 的次数、自恢复的次数等，具体数据可自定义。 

**0A** **子服务**：通过该服务科获取所有支持的故障码和故障状态信息，注意是所有的故障及故障码。 

这个服务大致简单的讲到这里吧，其实这个服务里面有 N 多内容，需要细细挖掘掌握。 

**22** **服务：** 

通过数据标识符的形式读取数据，例如我想读电机控制器里面的电机转速的信息，我就定义电机转速这个变量 标识符为 0x2000，（这是因为总线上基本不搞变量啊），所以我去请求电机转速时，我只需读该标识符的数据即可。 

**2E** **服务：** 

与 22 服务对应，表示通过数据标识符写入数据，一般来说，一个标识符可支持读，写操作是根据需求可选的。 

**23/3D** **服务：** 

23 是通过地址读数据 

3D 是通过地址写入数据，一般用的较少。 

**24/2A/2C/86** **服务：** 

这类服务用的较少，这里不再赘述； 

**27** **服务：** 

这个服务就是用来权限管理的，他的权限进入方式是： 

诊断仪 电机控制器 ECU 

1.  请求种子 --> 计算种子 
2.  接收种子 <-- 答复种子 
3.  发送密钥 --> 计算密钥 对比密钥4. 获取权限 <-- 返回权限切换状态 

比如你要向 ECU 写入数据，一般人当然不能随便写，只有专门懂的人才能写入，因此需要权限来保证。 

**28** **服务：** 

通信控制，包括对发送和接收消息的开关控制。 

**31** **服务：** 

例程控制，比如一些复杂的操作需要用他来实现，目前比较通用的包括烧录时的数据完整性检查、擦除内存等等。 

**2F** **服务：** 

IO 控制，主要用于对一些输入输出口的调试控制，目前这一块接触较少，比如一些传感器的开关控制。 

**34/35/36/37 服务： **

和数据传输有关的服务，包括请求传输、请求下载、数据传输、数据上传、退出传输等，这些服务和BootLoader 相关。 

**85** **服务：** 

用于控制故障的更新，包括开启和关闭故障更新，比如关闭之后不允许故障、故障状态、故障记录等信息的更新。开启则反之。